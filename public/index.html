<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="theme-color" content="#000000">

  <title>FaceOff</title>
</head>

<body>
  <noscript>
    Lets make some faces
  </noscript>
  <div id="root"></div>


  <video id="video" width="640" height="480" autoplay></video>
  <canvas id="canvas" width="640" height="480"></canvas>
  <script src="clmtrackr.js"></script>
  <script type="text/javascript">

    var video = document.getElementById('video');

    // Get access to the camera!
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
      // Not adding `{ audio: true }` since we only want video now
      navigator.mediaDevices.getUserMedia({ video: true }).then(function (stream) {
        video.src = window.URL.createObjectURL(stream);
        //video.play();
      });
    }

    var canvas = document.getElementById('canvas');
    var videoInput = document.getElementById('video');
    const ctracker = new clm.tracker({ faceDetection: { useWebWorkers: true } });
    let position44 = [];
    let position50 = [];
    //const videoInput = document.getElementById('inputVideo'); // console.log("********", clm)


    ctracker.init();
    ctracker.start(videoInput);

    console.log("ctracker-->", ctracker);

    function positionLoop() {
      requestAnimationFrame(positionLoop);
      var positions = ctracker.getCurrentPosition(); //
      // console.log("Position 44", positions[44])
      // console.log("Position 50", positions[50])
      position44 = positions[44];
      position50 = positions[50];
      //console.log(position44)
      // positions = [[x_0, y_0], [x_1,y_1], ... ] //
      // do something with the positions ... //
      //trackMouth(position44, position50)


    }
    positionLoop();



    const canvasInput = document.getElementById('canvas'); //
    const cc = canvasInput.getContext('2d');

    function drawLoop() {
      requestAnimationFrame(drawLoop);
      cc.clearRect(0, 0, canvasInput.width, canvasInput.height);
      ctracker.draw(canvasInput);
      console.log(position44)
      cc.moveTo(position44[0], position44[1])
      cc.lineTo(position50[0], position50[1])
      cc.strokeStyle = "red";
      cc.stroke();
    }
    drawLoop();


  </script>
</body>

</html>
